<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>iReserve | Online Bookings</title>
        <script src="https://cdn.tailwindcss.com"></script>
    </head>
    <body class="bg-gray-100 tracking-[0.1em]">
        <nav class="bg-white py-3">
            <div class="max-w-7xl mx-auto px-4">
                <div class="flex justify-between h-16">
                    <div class="flex">
                        <div class="flex-shrink-0 flex items-center">
                            <a href="/" class="font-bold text-2xl text-primary">iReserve</a>
                        </div>
                    </div>
                    <div class="flex items-center space-x-7">
                        <button id="login-btn" th:text="${hasActiveSession == true ? 'Dashboard' : 'Login'}" class="cursor-pointer text-primary focus:ring-2 focus:ring-offset-2 focus:ring-primary hover:bg-secondary hover:text-primary px-10 py-2 border border-primary rounded-md"></button>
                        <button id="signup-btn" class="cursor-pointer bg-primary focus:ring-2 focus:ring-offset-2 focus:ring-primary text-white hover:bg-primary px-10 py-2 rounded-md">Sign Up</button>
                    </div>
                </div>
            </div>
        </nav>
        <section class="bg-white py-20">
            <div class="max-w-7xl mx-auto px-4">
                <div class="text-center">
                    <h1 class="text-4xl font-bold text-gray-800 leading-tight">Welcome to iReserve</h1>
                    <p class="mt-4 text-xl text-gray-600">Book your reservations with ease!</p>
                    <div class="mt-6">
                        <button id="get-started" class="bg-primary cursor-pointer focus:ring-2 focus:ring-offset-2 focus:ring-primary hover:bg-primary text-white px-6 py-3 rounded-md text-lg">Get Started</button>
                    </div>
                </div>
            </div>
        </section>
        <section class="bg-lightgray py-20">
            <span id="has-active-session" th:if="${hasActiveSession}" class="hidden"></span>
            <div class="max-w-7xl mx-auto px-4">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10">
                    <div class="bg-gradient-to-br from-white to-secondary shadow-sm rounded-lg p-6">
                        <h2 class="text-xl font-semibold text-gray-900 mb-4">Easy Booking Process</h2>
                        <p class="text-gray-600">Our simple and intuitive booking system makes reservations hassle-free.</p>
                    </div>
                    <div class="bg-gradient-to-br from-white to-secondary shadow-sm rounded-lg p-6">
                        <h2 class="text-xl font-semibold text-gray-900 mb-4">Flexible Options</h2>
                        <p class="text-gray-600">Choose from a variety of options and customize your reservations.</p>
                    </div>
                    <div class="bg-gradient-to-br from-white to-secondary shadow-sm rounded-lg p-6">
                        <h2 class="text-xl font-semibold text-gray-900 mb-4">24/7 Support</h2>
                        <p class="text-gray-600">Need help? Our support team is available to assist you.</p>
                    </div>
                </div>
            </div>
        </section>
        <footer class="bg-gray-800 py-12">
            <div class="max-w-7xl mx-auto px-4">
                <div class="sm:flex justify-between items-center">
                    <p class="text-gray-400">Â© 2024 iReserve. All rights reserved.</p>
                    <div class="max-sm:mt-4 max-sm:space-x-6">
                        <a href="#" class="text-gray-400 hover:text-white sm:px-3 py-2">Privacy Policy</a>
                        <a href="#" class="text-gray-400 hover:text-white sm:px-3 py-2">Terms of Service</a>
                    </div>
                </div>
            </div>
        </footer>
        <div id="login-modal" style="color: #696969; background-color: #19191940; border-color: #292929" class="hidden text-sm modal fixed inset-0 bg-opacity-10 backdrop-filter backdrop-blur-md border border-opacity-30 flex items-center justify-center z-30">
            <div style="min-height: fit-content; background-color: #fafafa" class="w-[80%] md:w-2/3 2xl:w-1/3 relative rounded-3xl shadow-sm border border-gray-7">
                <p class="text-xl text-primary font-medium text-center opacity-100 my-4">Login</p>
                <hr style="color: #292929" class="h-1" />
                <div class="shadow-sm rounded-b-3xl p-6 block relative">
                    <form th:action="@{/login}" th:method="post" th:object="${userDto}" autocomplete="off" class="space-y-3 w-full">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        <p id="login-error-msg" th:if="${param.error}" class="text-red-600 transform font-medium text-center w-full text-md">Invalid Credentials</p>
                        <div>
                            <label for="username" class="block text-sm font-medium text-gray-700 w-fit">Username*</label>
                            <input type="text" id="username" th:field="*{username}" placeholder="Username" name="username"
                                   class="mt-1 block w-full px-3 py-3 border border-[#292929]/20 rounded-md focus:outline-none focus:border-primary  sm:text-sm">
                        </div>
                        <div class="pb-8">
                            <label for="password" class="block text-sm font-medium text-gray-700 w-fit">Password*</label>
                            <input type="password" placeholder="Password" th:field="*{password}" id="password"  name="password"
                                   class="mt-1 block w-full px-3 py-3 border border-[#292929]/20 rounded-md focus:outline-none focus:border-primary  sm:text-sm">
                        </div>
                        <button id="close-login-modal" type="button" class="text-md block absolute bottom-0 left-0 w-fit bg-red-500 text-white inline-flex justify-center rounded-bl-3xl rounded-tr-3xl px-10 py-2 focus:ring-2 focus:ring-offset-2 focus:ring-red-600 font-medium text-md">Cancel</button>
                        <button id="login" disabled type="submit" class="disabled:cursor-not-allowed text-md block absolute bottom-0 right-0 w-fit bg-primary text-white inline-flex justify-center rounded-br-3xl rounded-tl-3xl px-10 py-2 focus:ring-2 focus:ring-offset-2 focus:ring-primary font-medium text-md">Login</button>
                    </form>
                    <hr style="color: #292929" class="h-1 pb-10 -mx-6" />
                </div>
            </div>
        </div>
        <div id="signup-modal" style="color: #696969; background-color: #19191940; border-color: #292929" class="hidden text-sm modal fixed inset-0 bg-opacity-10 backdrop-filter backdrop-blur-md border border-opacity-30 flex items-center justify-center z-30">
            <div style="min-height: fit-content; background-color: #fafafa" class="w-[80%] md:w-2/3 2xl:w-1/3 relative rounded-3xl shadow-sm border border-gray-7">
                <p class="text-xl text-primary font-medium text-center opacity-100 my-4">Sign up</p>
                <hr style="color: #292929" class="h-1" />
                <div class="shadow-sm rounded-b-3xl p-6 block relative">
                    <form th:action="@{/sign-up}" th:method="post" th:object="${userDto}" autocomplete="off" class="space-y-3 w-full">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        <span id="signup-error" th:if="${#fields.hasAnyErrors()}"></span>
                        <div>
                            <label for="signup-username" class="block text-sm font-medium text-gray-700 w-fit">Username*</label>
                            <input type="text" id="signup-username" th:field="*{username}" placeholder="Username" name="username"
                                   class="mt-1 block w-full px-3 py-3 border border-[#292929]/20 rounded-md focus:outline-none focus:ring-primary focus:border-primary sm:text-sm">
                            <span th:if="${#fields.hasErrors('username')}" class="block mt-1 text-[12px] text-start text-red-600" th:errors="*{username}"></span>
                        </div>
                        <div class="pb-8">
                            <label for="signup-password" class="block text-sm font-medium text-gray-700 w-fit">Password*</label>
                            <input type="password" placeholder="Password" th:field="*{password}" id="signup-password" name="password"
                                   class="mt-1 block w-full px-3 py-3 border border-[#292929]/20 rounded-md focus:outline-none focus:ring-primary focus:border-primary sm:text-sm">
                            <span th:if="${#fields.hasErrors('password')}" class="block mt-1 text-[12px] text-start text-red-600" th:errors="*{password}"></span>
                        </div>
                        <button id="close-signup-modal" type="button" class="text-md block absolute bottom-0 left-0 w-fit bg-red-500 text-white inline-flex justify-center rounded-bl-3xl rounded-tr-3xl px-10 py-2 focus:ring-2 focus:ring-offset-2 focus:ring-red-600 font-medium text-md">Cancel</button>
                        <button type="submit" class="text-md block absolute bottom-0 right-0 w-fit bg-primary text-white inline-flex justify-center rounded-br-3xl rounded-tl-3xl px-10 py-2 focus:ring-2 focus:ring-offset-2 focus:ring-primary font-medium text-md">Create</button>
                    </form>
                    <hr style="color: #292929" class="h-1 pb-10 -mx-6" />
                </div>
            </div>
        </div>
    </body>
</html>
<script>
    const loginBtn = document.getElementById("login-btn");
    const loginModal = document.getElementById("login-modal");
    const closeLoginModal = document.getElementById("close-login-modal");
    const loginErrorMsg = document.getElementById("login-error-msg");
    const signupBtn = document.getElementById("signup-btn");
    const signupModal = document.getElementById("signup-modal");
    const closeSignupModal = document.getElementById("close-signup-modal");
    const signupError = document.getElementById("signup-error");
    const getStarted = document.getElementById("get-started");
    const hasActiveSession = document.getElementById("has-active-session");
    const username = document.getElementById("username");
    const password = document.getElementById("password");
    const login = document.getElementById("login");

    loginBtn.addEventListener("click", showLoginModal);
    closeLoginModal.addEventListener("click", hideLoginModal);
    signupBtn.addEventListener("click", showSignupModal);
    closeSignupModal.addEventListener("click", hideSignupModal)
    getStarted.addEventListener("click", showSignupModal);
    username.addEventListener("input", validateLoginInput);
    password.addEventListener("input", validateLoginInput);

    function showLoginModal(e) {
        e.preventDefault();
        if (hasActiveSession) {
            return window.location.href = "/app";
        }
        return loginModal.classList.remove("hidden");
    }
    function hideLoginModal(e) {
        e.preventDefault();
        return loginModal.classList.add("hidden");
    }
    function showSignupModal(e) {
        e.preventDefault()
        return signupModal.classList.remove("hidden");
    }
    function hideSignupModal(e) {
        e.preventDefault();
        return signupModal.classList.add("hidden");
    }
    function validateLoginInput() {
        login.disabled = username.value.trim() === ''
            || password.value.trim() === '';
    }

    if (loginErrorMsg) {
        loginModal.classList.remove("hidden");
    }
    if (signupError) {
        signupModal.classList.remove("hidden");
    }

    tailwind.config = {
        theme: {
            extend: {
                colors: {
                    primary: '#008000',
                    secondary: '#00800025',
                    danger: '#E62C46',
                    lightgray: '#19191905'
                }
            }
        }
    }
</script>